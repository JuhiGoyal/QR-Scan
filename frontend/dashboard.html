<!DOCTYPE html>
<html>
<head>
  <title>Dashboard</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">
  <h1>Dashboard</h1>
  <div id="users"></div>
</div>

<script>
  // ðŸ‘‰ REMOVE localhost before uploading:
  // const API_BASE = "http://localhost:3000";
  const API_BASE = "https://qr-backend-5qot.onrender.com";

  function safe(v) {
    return (v === undefined || v === null || v === "") ? "-" : v;
  }

  function loadUsers() {
    fetch(`${API_BASE}/users`)
      .then(r => r.json())
      .then(data => {
        users.innerHTML = data.map(u => `
          <div class="card">
            <h3>${safe(u.name)}</h3>

            <p><b>Phone:</b> ${safe(u.phone)}</p>
            <p><b>Gender:</b> ${safe(u.gender)}</p>
            <p><b>Aadhaar:</b> ${safe(u.aadhaarNumber)}</p>
            <p><b>Address:</b> ${safe(u.address)}</p>

            <p><b>Car Voucher No:</b> ${safe(u.carVoucherNumber)}</p>
            <p><b>Car Number:</b> ${safe(u.carNumber)}</p>

            <p><b>Zone:</b> ${u.zone ? u.zone : "<span style='color:gray;'>Not Set</span>"}</p>

            <p><b>Manual Code:</b> ${safe(u.manualCode)}</p>

            <p><b>Gate:</b>
              <span class="badge ${u.gateStatus === 'IN' ? 'green' : 'red'}">
                ${safe(u.gateStatus)}
              </span>
            </p>

            <p><b>Washroom:</b>
              <span class="badge ${u.washroomStatus === 'IN' ? 'blue' : 'gray'}">
                ${safe(u.washroomStatus)}
              </span>
            </p>

            ${u.qrImageUrl
              ? `<img src="${u.qrImageUrl}" width="130">`
              : `<p>No QR Image</p>`
            }
          </div>
        `).join("");
      })
      .catch(err => {
        console.log("Dashboard Load Error:", err);
        users.innerHTML = `<h3 style="color:red;">Unable to load users</h3>`;
      });
  }

  loadUsers();
  setInterval(loadUsers, 3000);
</script>

</body>
</html>
